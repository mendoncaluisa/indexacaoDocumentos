Gatos virtuais: detectando e avaliando os impactos da
minerac¸ ˜ao de criptomoedas em infraestrutura p ´ublica
Victor R. Pires, Felipe R. Coutinho, Daniel S. Menasch´e, Claudio M. de Farias
1Universidade Federal do Rio de Janeiro (UFRJ), Cidade Universit´aria – RJ – Brasil
victorpires@labnet.nce.ufrj.br, felipecoutinho@tic.ufrj.br
sadoc@dcc.ufrj.br, claudiofarias@nce.ufrj.br
Abstract. Blockchains and cryptocurrencies represent a revolutionary way to
convert energy into a medium of exchange. Today, numerous applications for
blockchains and cryptocurrencies are envisioned for purposes ranging from in-
ventory control to banking applications. Naturally, in order to mine in an eco-
nomically viable way, regions where energy is plentiful and cheap, e.g., close to
hydroelectric plants or in certain countries where energy production is greater
than demand, are sought. The possibility of converting energy into cash, howe-
ver, also opens up opportunities for a new kind of cyber attack aimed at illegally
cryptocurrency mining. In this work, using data from January and February of
2018 from the Federal University of Rio de Janeiro - UFRJ, it was observed that
this threat is real and it is presented a projection of the costs and gains derived
from these attacks. This work also indicates ways of detection and mitigation of
these attacks that were successfully implemented at UFRJ.
Resumo. Blockchains e criptomoedas representam uma forma revolucion´aria
de converter energia em meio de troca. Atualmente, vislumbram-se in´umeras
aplicac¸ ˜oes para blockchains e criptomoedas, para fins que variam desde o con-
trole de invent´ario at´e aplicac¸ ˜oes banc´arias. Naturalmente, para se minerar
de forma economicamente vi´avel buscam-se regi˜oes nas quais a energia seja
abundante e barata, e.g., pr´oximas a usinas hidroel´etricas ou em determinados
pa´ıses onde a produc¸ ˜ao de energia ´e maior que a demanda. A possibilidade
de convers˜ao de energia em dinheiro, no entanto, tamb´em abre oportunidades
para um novo tipo de ataque cibern´etico que visa a minerac¸ ˜ao de criptomo-
edas. Nesse trabalho, usando dados de janeiro e fevereiro de 2018 da Uni-
versidade Federal do Rio de Janeiro - UFRJ, observou-se que tal ameac¸a ´e
real e apresenta-se uma projec¸ ˜ao dos custos e ganhos derivados desses ataque.
Indica-se tamb´em formas de detecc¸ ˜ao e mitigac¸ ˜ao desses ataques que foram
implementadas com sucesso na UFRJ.
1. Introduc¸ ˜ao
Com a popularizac¸ ˜ao das moedas virtuais, vˆem tamb´em popularizando-se um novo tipo
de ataque que ameac¸a os usu´arios da Internet. Tal ataque consiste no uso de CPU e
mem´oria dos usu´arios dom´esticos para fins de minerac¸ ˜ao excusa. Em 2018, foi reportado
que tal tipo de ataques j´a era mais prevalente que ataques cl´assicos, como DDoS, em
certas regi˜oes dos EUA [Segura 2018].
Este trabalho ´e focado em uma nova classe de ataques de minerac¸ ˜ao. Os ataques
previamente reportados na literatura [Segura 2018, R¨uth et al. 2018, Hong et al. 2018,
Kharraz et al. 2019, Zimba and Wang 2018] contavam com usu´arios honestos sendo ex-
plorados remotamente e possivelmente monitorados localmente. Neste trabalho, por ou-
tro lado, foi considerado usu´arios de infraestruturas p´ublicas, e.g., da Universidade Fe-
deral do Rio de Janeiro - UFRJ, cujas m´aquinas podem ser exploradas localmente, por
acesso f´ısico `as mesmas, e monitoradas remotamente, e.g., pela Diretoria de Seguranc¸a
da Informac¸ ˜ao da UFRJ. Esta distinc¸ ˜ao entre o presente trabalho e os demais traz uma
s´erie de novos desafios, conforme abordado no restante deste trabalho. Para todos os
fins pr´aticos, os “gatos” nas favelas tamb´em se enquadram dentro do conceito de infra-
estrutura p´ublica considerado neste trabalho, evidenciando problemas de ordem p´ublica
decorrentes de ataques de minerac¸ ˜ao no Brasil.
Como estudo de caso, neste trabalho estudou-se ac¸ ˜ao de atacantes que buscam
invadir m´aquinas da UFRJ para executarem processos de minerac¸ ˜ao de forma distribu´ıda,
aumentando sua rentabilidade com os ataques. As infraestruturas p´ublicas, em especial,
s˜ao grandes alvos desse tipo de ataque, uma vez que possuem um grande n´umero de
hosts, banda de Internet e energia abundante. Este estudo tem como objetivos (a) avaliar
a prevalˆencia de ataques de minerac¸ ˜ao na UFRJ e (b) analisar os dados gerados pelos
incidentes, a fim de gerar um padr˜ao de comportamento para a detecc¸ ˜ao desse tipo de
ataque.
Em resumo, as principais contribuic¸ ˜oes desse artigo s˜ao:
Foi descoberto que minerac¸ ˜ao ilegal de criptomoedas ´e prevalente Usando dados co-
letados na UFRJ, descobriu-se que a minerac¸ ˜ao ilegal de criptomoedas ocorre
dentro da infraestrutura p´ublica. Em particular, foram identificadas dezenas de
tentativas de minerac¸ ˜ao da criptomoeda Monero. Vislumbrou-se que essas tenta-
tivas sejam apenas uma pequena parcela do total, e que diferentemente de ataques
cl´assicos, que deixam um rastro nos trac¸os de banda da rede, a minerac¸ ˜ao de
criptomoedas pode ser muito dif´ıcil de detectar por envolver praticamente apenas
atividade local na m´aquina atingida.
Os custos e ganhos advindos da minerac¸ ˜ao ilegal foram estimados Por meio de expe-
rimentos controlados em laborat´orio, foram quantificados os custos e ganhos ad-
vindos da minerac¸ ˜ao. Em particular, verificou-se que os custos em duas das
configurac¸ ˜oes consideradas foram muito superiores aos ganhos. Tal achado pode
motivar um amplo aumento no uso ilegal de recursos.
S˜ao propostas novas formas de descobrir e mitigar minerac¸ ˜ao ilegal Baseado na ex-
periˆencia preliminar, apresentam-se formas ingˆenuas de descobrir e mitigar
minerac¸ ˜ao ilegal de criptomoedas. Em trabalhos futuros, pretende-se refinar tais
propostas por meio de experimentos controlados e da aplicac¸ ˜ao das mesmas em
ambientes reais.
O restante desse trabalho est´a organizado da seguinte forma: na Sec¸ ˜ao 2 s˜ao apre-
sentados fundamentos b´asicos sobre criptomoedas necess´arios para o entendimento do
restante deste artigo; na Sec¸ ˜ao 3 s˜ao contrastados os trabalhos relacionados com este
trabalho, enquanto a Sec¸ ˜ao 4 apresenta a metodologia de pesquisa; as Sec¸ ˜oes 5 e 6 apre-
sentam as principais descobertas, sobre prevalˆencia dos ataques de minerac¸ ˜ao na UFRJ
e sobre os estimados ganhos e custos decorrentes destes ataques; a Sec¸ ˜ao 7 cont´em uma
discuss˜ao mais ampla dos resultados onde destaca-se a Sec¸ ˜ao 7.1 que apresenta um breve
resumo com ideias que foram identificadas como promissoras para mitigar os ataques
discutidos neste trabalho; por fim, a Sec¸ ˜ao 8 conclui.
2. Fundamentos b´asicos sobre criptomoedas e ataques de minerac¸ ˜ao
Uma criptomoeda ´e um ativo digital projetado para funcionar como um meio de troca
que usa criptografia para proteger transac¸ ˜oes financeiras, controlar a criac¸ ˜ao de unidades
adicionais e verificar a transferˆencia de ativos. O processo de gerac¸ ˜ao de criptomoedas
em uma rede ´e denominado minerac¸ ˜ao. Este processo consiste em uma m´aquina despen-
der processamento para resolver um problema matem´atico e ser recompensada por essa
resoluc¸ ˜ao [Nakamoto 2008]. Todo esse processo demanda elevado consumo de energia e
poder de processamento, servic¸os estes que precisam ter os custos reduzidos para que a
minerac¸ ˜ao se torne um processo lucrativo ao minerador.
O uso de criptomoedas se tornou poss´ıvel devido aos avanc¸os tecnol´ogicos da
´ultima d´ecada. Por´em, esse uso n˜ao se restringiu somente ao apelo financeiro proposto
pela tecnologia, mas tamb´em a uma s´erie de novas abordagens usando conceitos que
surgiram durante o processo, como a blockchain, smartcontracs e distributed ledger.
As criptomoedas permitiram uma s´erie de transac¸ ˜oes financeiras em anonimato ou com
identificac¸ ˜ao dos envolvidos nessas transac¸ ˜oes dificultada.
Diferente do modelo centralizado dos sistemas banc´arios atuais, as criptomoedas
usam controle descentralizado que funciona atrav´es da tecnologia de contabilidade dis-
tribu´ıda, uma tecnologia que permite a realizac¸ ˜ao confi´avel e segura de qualquer transac¸ ˜ao
entre duas ou mais pessoas sem a necessidade de intermedi´arios, atrav´es da Internet. Nor-
malmente uma blockchain serve como banco de dados distribu´ıdo que guarda um registro
de transac¸ ˜oes permanente e `a prova de violac¸ ˜ao. A blockchain consiste em dois tipos de
registros: transac¸ ˜oes individuais e blocos.
O processo de minerac¸ ˜ao pode ser realizado em um ´unico computador ou utili-
zando um grupo destes. Na minerac¸ ˜ao “solo”, a recompensa gerada pelo processo de
minerac¸ ˜ao depende exclusivamente da potˆencia do computador, enquanto na minerac¸ ˜ao
em “pool” muitos computadores mineram juntos e a potˆencia acumulada aumenta as
chances de resoluc¸ ˜ao do bloco. Quando o bloco ´e resolvido, a recompensa ´e dividida
proporcionalmente de acordo com a potˆencia empregada por cada um.
2.1. Ataques de minerac¸ ˜ao
Nessa sec¸ ˜ao ´e apresentada uma breve introduc¸ ˜ao aos ataques de minerac¸ ˜ao, indicando
seus tipos cl´assicos e o que foi encontrado de diferente quando foca-se em infraestruturas
p´ublicas.
2.1.1. Tipos de ataques de minerac¸ ˜ao
Um ataque de minerac¸ ˜ao consiste na infecc¸ ˜ao de um ou mais hosts, inserindo neles um
malware que executa um software de minerac¸ ˜ao. Esta t´ecnica recebe o nome de crypto-
jacking (minerac¸ ˜ao de criptomoedas utilizando recursos do computador da v´ıtima). Atu-
almente, a furtividade desta t´ecnica tem dificultado a sua detecc¸ ˜ao por parte das equipes
de seguranc¸a, especialmente pelo fato de n˜ao ser poss´ıvel analisar todos os hosts, diante
do tamanho da rede e da ausˆencia de softwares de monitoramento instalados neles. Sendo
assim, a maneira mais eficiente de identificar os ataques muitas vezes consiste na busca
por tr´afego anˆomalo na rede da instituic¸ ˜ao (vide Sec¸ ˜ao 7).
Cabe destacar que este trabalho foi focado nos usu´arios que intencionalmente mi-
neram moedas virtuais em suas m´aquinas. Alternativamente, na literatura o foco tˆem sido
em usu´arios remotos executando tal minerac¸ ˜ao indesejada. Isso se d´a de duas formas:
via Javascript ou via worms. No primeiro caso, o c´odigo de minerac¸ ˜ao ´e executado no
browser e o download deste c´odigo ´e feito junto com o download da p´agina desejada
pelo usu´ario (de forma velada). J´a no caso do worm, o c´odigo ´e executado de forma in-
dependente do browser, sendo o download feito potencialmente de forma individual. O
worm tem capacidade de se replicar. No caso do Javascript, monitorando o uso de CPU
e mem´oria do browser, pode-se identificar o problema, enquanto que no caso do worm,
precisa-se monitorar o uso de CPU e mem´oria da m´aquina como um todo, pois n˜ao se
sabe de antem˜ao qual o processo que est´a fazendo a execuc¸ ˜ao maliciosa. Discute-se em
mais detalhes cryptojacking (tanto via Javascript quanto worms) na Sec¸ ˜ao 3.
2.1.2. Por que focar em infraestruturas p ´ublicas?
O problema dos ataques de minerac¸ ˜ao traz desafios adicionais em infraestruturas p´ublicas,
e.g., universidades, escolas e hospitais. Isso ocorre nas infraestruturas p´ublicas devido aos
usu´arios terem acesso f´ısico `as m´aquinas p´ublicas. Assim, torna-se mais f´acil ligar e des-
ligar mineradores fisicamente. Para se fazer uso de m´aquinas de usu´arios dom´esticos, por
exemplo, por meio de uma botnet, tais m´aquinas dom´esticas precisam conter vulnerabili-
dades que permitam o atacante invadir o sistema.
Uma vez que se inicia a minerac¸ ˜ao em uma m´aquina de uma infraestrutura p´ublica,
como ela n˜ao deixa poucos rastros na rede, pode se tornar muito dif´ıcil a detecc¸ ˜ao do
comprometimento da m´aquina. Monitorar a rede de transmiss˜ao de dados pode n˜ao ser
suficiente para identificar os ataques, que tˆem um aspecto fortemente local e n˜ao fazem
uso de vulnerabilidades de software. Assim, vislumbra-se uma cooperac¸ ˜ao necess´aria
entre as superintendˆencias de tecnologia e as redes prestadoras de energia para que tais
ataques sejam mitigados em larga escala.
3. Trabalhos relacionados
Existe uma ampla literatura sobre ataques de sequestro de minerac¸ ˜ao (crypto-
jacking) [Segura 2018, R¨uth et al. 2018, Hong et al. 2018, Kharraz et al. 2019,
Zimba and Wang 2018]. Nesses ataques, o usu´ario que tem a m´aquina sequestrada
tipicamente acessa uma p´agina que aparenta ser in´ocua mas que, de forma escondida,
executa Javascript de minerac¸ ˜ao usando recursos de CPU e mem´oria sem autorizac¸ ˜ao
do usu´ario. Alternativamente, o usu´ario ´e infectado por um worm que faz a minerac¸ ˜ao.
Em ambos os casos, a origem do ataque ´e externa `a m´aquina f´ısica. Neste trabalho,
considerou-se ataques que se d˜ao por usu´arios que tˆem acesso f´ısico `as m´aquinas.
Embora o tema de cryptojacking esteja em voga, n˜ao se observou nenhum trabalho
anterior que tenha analisado os riscos associados a este tipo de ataque em infraestruturas
p´ublicas, nos quais os usu´arios tenham acesso f´ısico aos dispositivos.
Trabalhos relacionados Neste trabalho
Ponto de monitoramento
(vantage point) local (extens˜ao do browser) remoto
Vetor de acesso
(access vector) remoto local (f´ısico)
Tabela 1. Comparac¸ ˜ao desse trabalho com os relacionados
3.1. Novos vetores de ataque e vetores de acesso
A Tabela 1 compara os trabalhos relacionados contra o presente trabalho. Em trabalhos re-
lacionados, os autores consideram que o browser de forma n˜ao intencional acessa scripts
de minerac¸ ˜ao (vetor de acesso remoto) e que o usu´ario honesto tem interese em monitorar
(localmente) devido a atividades suspeitas. Neste trabalho, por outro lado, assume-se que
o usu´ario intencionalmente executa scripts de minerac¸ ˜ao (vetor de acesso local, f´ısico) e
que o monitoramento precisa ser remoto, e.g., deep packet inspection (DPI).
3.2. “Gatos” virtuais e “gatos” f´ısicos
O problema considerado neste trabalho ´e particularmente complexo em pa´ıses em desen-
volvimento, como o Brasil, no qual temos uma significativa parcela da populac¸ ˜ao aces-
sando a rede el´etrica por meio de “gatos” f´ısicos, que potencialmente podem dar margem
a “gatos” virtuais [Setti 2018, Marini 2017].
Os “gatos” virtuais descritos neste trabalho, bem como aqueles estudados na
literatura de cryptojacking, podem ser apreciados como uma vers˜ao sofisticada dos
“gatos” f´ısicos t˜ao comuns em favelas. “Gatos” f´ısicos s˜ao prevalentes no Brasil
[Nadaud 2012, Penin 2008] e existe uma vasta literatura sobre os mesmos. Cabe des-
tacar que embora substanciais recursos, inclusive jur´ıdicos, tenham sido investidos para
detectar tais “gatos” f´ısicos e removˆe-los, estes continuam amplamente presentes. As-
sim, vislumbra-se que os ataques virtuais em infraestruturas p´ublicas, por serem mais
sutis, constituem uma ameac¸a maior que os ataques f´ısicos. A combinac¸ ˜ao dos dois, ou
seja, ataques virtuais sobre uma infraestrutura em que existem ataques f´ısicos, constitui o
cen´ario mais complexo.
3.3. Ataques de cryptojacking
In´umeros trabalhos recentes descrevem ataques de cryptojacking [Segura 2018,
R¨uth et al. 2018, Hong et al. 2018]. [Zimba and Wang 2018], por exemplo, descrevem
um atacante que direciona a m´aquina v´ıtima para uma servidor remoto e atrav´es de
t´ecnicas de escalac¸ ˜ao de privil´egio (do inglˆes, privilege escalation), e transforma a
m´aquina v´ıtima em um recurso de minerac¸ ˜ao para o atacante. Se as mensagens tro-
cadas pelo atacante e a v´ıtima tiverem padr˜oes suspeitos, e.g., de tamanho de pacotes,
tempo entre pacotes ou se acessarem IPs marcados em listas negras, pode-se identificar
os ataques [Kharraz et al. 2019, K¨uhrer et al. 2014, Coinblockerlists 2018].
3.4. Detectando cryptojacking
Tipicamente cryptojacking ´e detectado in browser (ou seja, pelo pr´oprio browser). O
browser executa um monitor, que faz an´alises do Javascript e intercepta crypto scripts.
Tal monitor pode ser, por exemplo, uma extens˜ao do browser (similar `as extens˜oes para
economia de energia). Dois exemplos de extens˜oes que fazem detecc¸ ˜ao de minerac¸ ˜ao
indesejada s˜ao NoCoin [Keramidas 2018] e MinerBlock [Cherone and Mahon 2018].
Este trabalho considera o cen´ario no qual n˜ao se pode detectar o ataque a partir do
browser, tendo em vista que o usu´ario da m´aquina intencionalmente executou o script de
minerac¸ ˜ao (Tabela 1). Precisa-se detectar o ataque a partir da rede, e mostra-se que isso ´e
poss´ıvel, por exemplo, usando (DPI).
Alternativamente, se DPI n˜ao for vi´avel (e.g., por os pacotes estarem criptogra-
fados com o uso de uma VPN), pode-se ainda avaliar apenas o IP origem e destino
dos mesmos, e buscar por eles em listas negras [Kharraz et al. 2019, K¨uhrer et al. 2014,
Coinblockerlists 2018]. Pode-se tamb´em avaliar o tamanho dos pacotes e o tempo m´edio
entre pacotes, na busca por padr˜oes suspeitos. Isso possivelmente pode inclusive ser feito
investigando consultas aos servidores DNS.
Caso n˜ao seja poss´ıvel descobrir os ataques apenas com medic¸ ˜oes em re-
des, pode ser necess´ario monitorar remotamente a telemetria das mesmas (CPU e
mem´oria) [Avritzer et al. 2010]. Esse monitoramento pode ser feito em universidades,
nos quais os computadores est˜ao todos sob a mesma autoridade, mas n˜ao em favelas, por
exemplo. Os contadores de desempenho (performance counters ou performance signatu-
res) tipicamente s˜ao capazes de identificar atividade de minerac¸ ˜ao, que aumenta em muito
o uso da CPU. Entretanto, monitorar a CPU de um n´umero grande de m´aquinas pode ser
desafiador. Assim, acredita-se que, em um futuro pr´oximo, o monitoramento remoto via
rede seguido pela inspec¸ ˜ao detalhada das m´aquinas suspeitas, ainda ser´a a soluc¸ ˜ao mais
comum, conforme considerada neste trabalho, e detalhada na sec¸ ˜ao a seguir.
4. Metodologia
A seguir, ´e descrita a metodologia experimental de medic¸ ˜ao da UFRJ, focada no monito-
ramento da prevalˆencia de minerac¸ ˜ao nos campis, e na Sec¸ ˜ao 6 ´e descrita a metodologia
utilizada para a realizac¸ ˜ao de experimentos controlados em laborat´orio para averiguar
ganhos e perdas decorrentes da minerac¸ ˜ao.
4.1. Sistemas de monitoramento na UFRJ
A UFRJ possui diversos sistemas de detecc¸ ˜ao de invas˜oes e ameac¸as que s˜ao utilizados
para prover seguranc¸a de seus alunos, docentes e funcion´arios. Nesse trabalho, ser˜ao
utilizados os dados fornecidos por duas ferramentas utilizadas pela equipe de Seguranc¸a
da Informac¸ ˜ao: SGIS - Sistema de Gest˜ao de Incidentes de Seguranc¸a, fornecido pela
Rede Nacional de Ensino e Pesquisa (RNP) e o sistema de gest˜ao de tickets. O SGIS
gera chamados utilizando o resultado das varreduras do tr´afego de rede no PoP-RJ (Ponto
de Presenc¸a da RNP no Rio de Janeiro), por onde passam quase todo o tr´afego da rede
acadˆemica do Estado destinado `a Internet. O sistema de tickets inclui chamados requisi-
tados pelos membros da UFRJ.
4.2. Descoberta de ataques de minerac¸ ˜ao na UFRJ
A descoberta dos ataques de minerac¸ ˜ao inicia-se com a notificac¸ ˜ao de alguma irregu-
laridade. As notificac¸ ˜oes de irregularidades na UFRJ ocorrem pelas seguintes formas,
executadas em paralelo:
• notificac¸ ˜ao das instituic¸ ˜oes parceiras e ´org˜aos de governo informando que o host
est´a se comunicando com outras m´aquinas mineradoras infectadas;
• monitoramento de tr´afego de rede da universidade verificando se o host est´a se co-
municando com servidores de minerac¸ ˜ao, tamb´em conhecidos como mining pools;
• notificac¸ ˜oes dos usu´arios das m´aquinas indicando anomalias no comportamento
do host.
A partir da notificac¸ ˜ao, ´e feita uma auditoria f´ısica nas m´aquinas suspeitas, para se detectar
o poss´ıvel vetor de ataque envolvido. Nessa auditoria, tamb´em s˜ao coletados dados sobre
as configurac¸ ˜oes das m´aquinas envolvidas.
A per´ıcia f´ısica consiste em:
1. encaminhamento f´ısico at´e a m´aquina;
2. an´alise da finalidade da m´aquina e das conex˜oes ativas usando wireshark ou
tcpdump, em conjunto com o netstat (e.g., muitas conex˜oes UDP ativas para
um computador pessoal de um professor do departamento de hist´oria pode indicar
suspeita de que a m´aquina foi comprometida);
3. an´alise das vulnerabilidades da m´aquina, sob uma vis˜ao externa, e.g., Shodan;
4. an´alise das vulnerabilidades da m´aquina, sob uma vis˜ao interna, e.g., usando ras-
treador de vulnerabilidades do Apache provida pelo Kali Linux caso o mesmo
esteja instalado na m´aquina;
5. busca nas pastas da m´aquina (em particular, nos subdiret´orios do Apache) por
um arquivo (bin´ario) que tipicamente seja usado para fins il´ıcitos. Este trabalho
foi focado na busca por arquivos de minerac¸ ˜ao de criptomoedas, atrav´es de uma
busca nos nomes de todos os arquivos da m´aquina pelas strings listadas na
Tabela 2;
6. busca no cron do sistema por agendamento de processos de minerac¸ ˜ao, bem
como no hist´orico do bashrc, pelas mesmas strings da Tabela 2;
7. busca no hist´orico de sites acessados por sites suspeitos. Por exemplo, no caso de
suspeita de minerac¸ ˜ao de criptomoedas, verifica-se se existem registros de acesso
a algum dos sites de minerac¸ ˜ao publicamente conhecidos, e.g., http://btc.
com.
string justificativa
miner indica minerador
mining indica minerador
xmr sigla do Monero
bitcoin na busca por Bitcoin
ethereum na busca por Ethereum
monero na busca por Monero, uma criptomoeda prevalente no Brasil
Tabela 2. Strings usadas na busca por mineradores de criptomoedas
Um vetor de ataque ´e o m´etodo pelo qual um ataque atinge seu alvo
[Wu et al. 2011]. Os vetores de ataque que foram encontrados na UFRJ durante as audi-
torias dos ataques foram: (i) vetores epidˆemicos virtuais (worms); (ii) vetores espec´ıficos
virtuais (ataques `a rede, advindos de uma conex˜ao de Internet); (iii) vetores espec´ıficos
(a) janeiro de 2018
(b) fevereiro de 2018
Figura 1. N ´umero de incidentes em janeiro de e fevereiro de 2018
f´ısicos (ataques `a rede, advindos de uma acesso f´ısico aos computadores). No caso par-
ticular de minerac¸ ˜ao de criptomoedas, o acesso f´ısico `as m´aquinas representa um impor-
tante vetor de potencial dif´ıcil detecc¸ ˜ao.
Algums worms foram encontrados em casos de computadores p´ublicos de lugares
com ampla circulac¸ ˜ao de pessoas, como em laborat´orios e bibliotecas. Os ataques `as redes
foram detectados em servidores utilizados para hospedagem de sites e armazenamento de
arquivos. J´a os ataques f´ısicos foram identificados quando executados por usu´arios dos
equipamentos, intencionalmente, para minerac¸ ˜ao em benef´ıcio pr´oprio.
5. Prevalˆencia da minerac¸ ˜ao ilegal
5.1. Caso estudado na UFRJ
A UFRJ foi v´ıtima de ciberataques com a finalidade de minerar criptomoedas durante
o per´ıodo de janeiro at´e fevereiro de 2018. Em fevereiro de 2018 implementaram-se
as estrat´egias de mitigac¸ ˜ao descritas na Sec¸ ˜ao 7.1, e desde ent˜ao tem sido mais dif´ıcil
identificar ataques de minerac¸ ˜ao.
Esse estudo ´e focado nas notificac¸ ˜oes recebidas entre 7 de janeiro e 28 de feve-
reiro. O estudo desses ataques foi usado para gerar as m´etricas do experimento de ganhos
e custos estimados com a minerac¸ ˜ao. A Figura 1 reporta o n´umero de notificac¸ ˜oes de inci-
dentes de seguranc¸a durante o per´ıodo analisado. Elas abrangem notificac¸ ˜oes de diversos
tipos de ataques, incluindo DDoS, violac¸ ˜ao de direitos autorais e ataques de forc¸a bruta a
ssh.
Na Figura 1 nota-se que existem per´ıodos cont´ıguos de maior atividade de
notificac¸ ˜oes, por exemplo, entre 25 de janeiro de 2 de fevereiro, e entre 19 de fevereiro e
25 de fevereiro. Temos poucas notificac¸ ˜oes em outros per´ıodos cont´ıguos, por exemplo,
entre 1 e 8 de janeiro, e entre 11 e 16 de fevereiro. O principal motivo para termos es-
Figura 2. N ´umero de incidentes com finalidade de minerac¸ ˜ao de criptomoedas
ses per´ıodos cont´ıguos relaciona-se ao fato de que, quando um ataque ocorre, o atacante
que passou pelo firewall muitas vezes consegue comprometer v´arias m´aquinas. Quando o
problema ´e mitigado, volta-se para uma fase de calmaria.
Desses incidentes notificados, foram reconhecidos como ataques de minerac¸ ˜ao
144 casos. As datas das notificac¸ ˜oes destes casos est˜ao reportadas na Figura 2. As
notificac¸ ˜oes s˜ao di´arias e s˜ao geradas pelo script que pega informac¸ ˜oes do backbone e
faz deep packet inspection. O script ´e executado ao longo do dia e ap´os o fim do dia, esse
recomec¸a a contagem das notificac¸ ˜oes. Isto explica porque, em quase todos os dias, o
n´umero de notificac¸ ˜oes variou entre 7 e 6. Provavelmente os dispositivos comprometidos
e os usu´arios executando minerac¸ ˜ao eram sempre os mesmos, e sua atividade di´aria gerou
em torno de 7 notificac¸ ˜oes prediz´ıveis por dia (e.g., na comunicac¸ ˜ao entre o usu´ario e a
central de minerac¸ ˜ao). Cabe destacar que em alguns dias, como por exemplo, no dia 27
de janeiro (s´abado) n˜ao houve comunicac¸ ˜ao devido a rede da UFRJ ser inst´avel nos fins
de semana, quando ocorre `a manutenc¸ ˜ao nesta.
Em determinados dias, por exemplo, no dia 24 de janeiro, tivemos uma baixa no
n´umero de notificac¸ ˜oes que, em seguida, aumentou no dia 25 de janeiro. Isto deve-se ao
fato de que no dia 24 de janeiro o problema da minerac¸ ˜ao foi sanado provisoriamente,
reinstalando-se algumas m´aquinas do sistema. Entretanto, o problema retornou porque
o vetor de ataque ainda estava ativo e reiniciou suas atividades no dia 25 de janeiro. A
seguir, ser´a descrito em mais detalhes um dos epis´odios ocorridos neste per´ıodo.
Epis´odio de minerac¸ ˜ao Bitcoin: Em uma unidade da UFRJ, identificou-se com-
putadores minerando Bitcoin. A partir do hist´orico de navegac¸ ˜ao do browser, constatou-se
que um usu´ario havia acessado sites de mining pools. Dentre eles, destacaram-se os sites
http://btc.com e http://f2pool.com. Nesses sites, o usu´ario faz login com
sua conta e basta deixar o computador ligado para arrecadar recursos de minerac¸ ˜ao. Por
descuido, o usu´ario deixou um arquivo com um rastro de seu login e senhas de minerac¸ ˜ao
na m´aquina. Com as credenciais de acesso `as pools, foi poss´ıvel identificar os instantes
de in´ıcio e fim de cada atividade de minerac¸ ˜ao.
Configurac¸ ˜ao 1 Configurac¸ ˜ao 2 Configurac¸ ˜ao 3
Processador Intel Pentium Dual Core Intel Core i3 Intel Core i5
N ´ucleos 02 02 04
Mem´oria RAM 04 Gb 04 Gb 04 Gb
Tabela 3. Configurac¸ ˜oes de m ´aquinas usadas em nossos experimentos
Cabe destacar que a notificac¸ ˜ao do evento acima alertou a equipe de seguranc¸a
para tomar as iniciativas anteriormente ditas, foi gerada pelo fato de ter ocorrido acesso
ao site da mining pool, que por sua vez gerou tr´afego suspeito. Isto ocorreu pelo descuido
do usu´ario ao fazer a minerac¸ ˜ao. Caso a minerac¸ ˜ao fosse cuidadosamente executada a fim
de produzir o m´ınimo de interac¸ ˜oes com o restante da rede, acredita-se que teria sido mais
dif´ıcil detectar a atividade suspeita.
Dentre as moedas virtuais mais mineradas na UFRJ, destacaram-se o Bitcoin e o
Monero.
Bitcoin: O Bitcoin foi a primeira moeda virtual a ser adotada em larga escala, o
que justifica sua prevalˆencia na UFRJ. O Bitcoin funciona como um lastro para as outras
criptomoedas e j´a existem in´umeros programas simples para minerar Bitcoin em qualquer
plataforma (Linux, MacOS, Android e Windows, nas mais diversas vers˜oes).
Monero: O Monero [Andersen 2014] proporciona aos seus usu´arios n´ıveis de
privacidade maiores que aqueles oferecidos pelo Bitcoin. Al´em disso, ele tamb´em provˆe
as facilidades em termos de software de minerac¸ ˜ao para script kiddies. Por esses moti-
vos, muitos mineradores tˆem adotado o Monero como criptomoeda de primeira escolha,
conforme identificado nas medic¸ ˜oes.
6. Ganhos e custos estimados com a minerac¸ ˜ao
A seguir, apresentam-se resultados obtidos com experimentos controlados em laborat´orio
para estimar os ganhos e custos associados `a minerac¸ ˜ao na UFRJ. Em particular, emulam-
se as configurac¸ ˜oes das m´aquinas que descobriram-se estarem minerando, entre janeiro e
feveiro de 2018, conforme descrito anteriormente na Sec¸ ˜ao 5.
6.1. Ambiente do experimento controlado
Consideram-se trˆes configurac¸ ˜oes que correspondem `as m´aquinas mineradoras de Mo-
nero e Bitcoin encontradas na UFRJ (vide Sec¸ ˜ao 5). N˜ao ´e surpreendente que tais
configurac¸ ˜oes siguam padr˜oes encontrados em computadores nos diversos setores da
instituic¸ ˜ao, visto que as compras de equipamentos s˜ao feitas em lotes. Assim, as
configurac¸ ˜oes tamb´em capturam de forma mais ampla os potenciais ganhos e custos de
minerac¸ ˜ao na UFRJ como um todo. A Tabela 3 resume as configurac¸ ˜oes.
O experimento contou com 3 m´aquinas. Para cada configurac¸ ˜ao apresentada na
Tabela 3, considera-se uma m´aquina mineradora, que passou o per´ıodo do experimento
minerando. Os hosts executam o sistema operacional Linux Ubuntu 16.04 e o software de
monitoramento de consumo de energia PowerTOP. O software de minerac¸ ˜ao escolhido
foi o MinerGate, que minera a moeda virtual Monero (vide Sec¸ ˜ao 5). Para fins de coleta
de dados da rede (monitoramento de fluxos de rede) utilizou-se o NFDump (netflow) e
para visualizar os fluxos foi usado o NFsen e RRD Graphics.
Hashing power (frequˆencia de minerac¸ ˜ao)
Descric¸ ˜ao Config. 1 Config. 2 Config. 3
Hashing por host ( r ) 85 H/s 88 H/s 177 H/s
Hashing total, assumindo N = 3 ( R = N r ) 255 H/s 264 H/s 531 H/s
Consumo de energia
Consumo energ´etico por host ( e ) 21 W/h 38 W/h 40 W/h
Consumo energ´etico total em KW por dia,
assumindo N = 3 (N E = 24 × 10−3N e) 1,512 KW 2,736 KW 2,880 KW
Custo total, assumindo N = 3 (C = N Ec) R$ 0,92 R$ 1,67 R$ 1,76
Ganhos totais com 1/100 de pool fee1
Total minerado (XMR) em 24 horas 0,0001563 0,0001618 0,003254
Ganho total ( G ) em reais R$ 0,27 R$ 0,28 R$ 5,61
Tabela 4. Custos e ganhos totais de minerac¸ ˜ao de Monero com 3 hosts e as
respectivas configurac¸ ˜oes (vide Tabela 3) (conforme Fig. 2, houve uma m ´edia de
tr ˆes hosts ativos minerando na UFRJ em janeiro e fevereiro de 2018).
6.2. Resultados experimentais
A Tabela 4 ilustra os custos e ganhos associados `a minerac¸ ˜ao de Monero na infraestrutura
t´ıpica da UFRJ, utilizando cada configurac¸ ˜ao apresentada na Tabela 3.
Seja N o n´umero de hosts minerando ao longo do per´ıodo de observac¸ ˜ao, para
cada uma das configurac¸ ˜oes. Neste trabalho, considera-se N = 3. Optou-se por utilizar
este valor pelo fato de que, na m´edia observou-se em torno de 3 incidentes de minerac¸ ˜ao
durante o per´ıodo observado entre janeiro e fevereiro de 2018 (vide Sec¸ ˜ao 5).
Cabe destacar que no experimento minerou-se apenas via CPU. Em geral, pode-se
minerar via CPU e GPU. Entretanto, como as m´aquinas da UFRJ em geral n˜ao possuem
GPU, optou-se pela primeira opc¸ ˜ao.
A minerac¸ ˜ao ocorreu durante o per´ıodo de dois meses. Por´em, em alguns dias
do experimento, ocorreram falhas no fornecimento de energia el´etrica e de conectividade
com a internet. Assim, optou-se por apresentar uma amostra de 24 horas, onde, al´em de
demonstrar dados ´ıntegros, torna mais f´acil a compreens˜ao do trabalho. Seja r(j) o poder
de hashing de cada m´aquina, na configurac¸ ˜ao j e H/s representando hashes por segundo.
Nas medic¸ ˜oes reportou-se r(1) = 85 H/s , r(2) = 88 H/s e r(3) = 177 H/s, respectivamente.
O poder de hashing total ´e dado por R(j) no sistema j, j = 1, 2, 3, R(j) = N r(j).
O ganho di´ario correspondente ao poder de hashing reportado acima, com os 3
hosts, ´e dado por G(1) = R$ 0,27, G(2) = R$ 0,28 e G(3) = R$ 5,61, nas configurac¸ ˜oes
1, 2 e 3 respectivamente. Para a obtenc¸ ˜ao de tais valores, foi utilizada a cotac¸ ˜ao m´edia do
Monero em reais no per´ıodo de estudo. Embora o poder de hash da configurac¸ ˜ao 3 seja de
aproximadamente o dobro daquele reportado nas configurac¸ ˜oes 1 e 2, fatores aleatorios
inerentes `a minerac¸ ˜ao causaram um ganho relativo muito superior na configurac¸ ˜ao 3, no
estudo de caso considerado. Nas configurac¸ ˜oes 1 e 2 os ganhos esperados s˜ao pequenos
comparados com os gastos energ´eticos e custos monet´arios, conforme indicado a seguir.
Para estimar o gasto energ´etico por host, mediu-se o consumo energ´etico das
1Taxas de utilizac¸ ˜ao da moeda
Figura 3. Tr ´afego total dos hosts no experimento
m´aquinas. Os valores medidos por m´aquina foram e(1) = 21 W/h, e(2) = 38 W/h e
e(3) = 40 W/h, para as configurac¸ ˜oes 1, 2 e 3, respectivamente. Multiplicando pelo
n´umero de hosts ativos, e pelo custo de energia1 obtemos o custo total estimado por dia,
C(j) = 0, 024e(j)N c = E(j)N c, onde o custo c ´e medido em reais por KW e o consumo
de energia E em KW por dia.
At´e ent˜ao, n˜ao foram levados em considerac¸ ˜ao os padr˜oes de rede associados `a
minerac¸ ˜ao no experimento controlado, nem os custos de rede subjacentes. Para uma
an´alise preliminar sobre aspectos de rede s˜ao consideradas, al´em das 3 m´aquinas menci-
onadas at´e ent˜ao, mais 3 m´aquinas, com as mesmas configurac¸ ˜oes. Tais m´aquinas adi-
cionais s˜ao m´aquinas baseline, que executam aplicac¸ ˜oes de um desktop de uso geral, e
que n˜ao fazem minerac¸ ˜ao. Um dos prop´ositos ´e contrastar o uso de rede das m´aquinas
correspondentes (Figura 3).
Conforme indicado na Figura 3, o padr˜ao de tr´afego dos hosts que est˜ao re-
alizando a minerac¸ ˜ao ´e inferior ao dos hosts executando atividades padr˜oes de equi-
pamentos da UFRJ. Este fato corrobora a ideia de que ´e mais desafiador identi-
ficar ataques de minerac¸ ˜ao remotamente, conforme considerado neste trabalho, em
comparac¸ ˜ao com uma detecc¸ ˜ao local no browser, usando ferramentas do tipo mine bloc-
kers [Cherone and Mahon 2018] (vide Tabela 1).
7. Discuss˜ao
Nesta sec¸ ˜ao, s˜ao discutidos aspectos mais amplos relacionados ao trabalho, alguns dos
quais s˜ao fruto de pesquisa corrente ou de trabalhos futuros.
7.1. Mitigac¸ ˜ao de ataques de minerac¸ ˜ao: um estudo de caso na UFRJ
Para mitigar os ataques sofridos pelas m´aquinas, foi definida uma pol´ıtica de atuac¸ ˜ao
constitu´ıda pelos seguintes passos: (1) Restaurac¸ ˜ao de backups n˜ao comprometidos, caso
existam; (2) Remoc¸ ˜ao de worms e malwares; (3) Bloqueio dos IPs de mining pools e de
sites de mineradoras. Adotando a pol´ıtica acima, a partir de marc¸o de 2018, identificou-se
que o n´umero de casos reportados de minerac¸ ˜ao na UFRJ diminuiu significativamente. A
inserc¸ ˜ao de sanc¸ ˜oes legais na pol´ıtica de seguranc¸a da informac¸ ˜ao tamb´em poderia reduzir
este tipo de incidente.
1Custo / KW- Jan.2018 - R$ 0,61 - Valor informado no site da companhia fornecedora.
7.2. Identificac¸ ˜ao autom´atica de minerac¸ ˜ao
Como forma de identificar automaticamente os ataques de minerac¸ ˜ao considerados neste
artigo, ´e imperativo que o sistema de IDS esteja preparado para detectar o comporta-
mento de malwares voltados a minerac¸ ˜ao. Em trabalhos futuros, pretende-se elaborar
um estudo baseado nos padr˜oes do tr´afego de rede encontrados, a fim de que sejam
identificadas as comunidades ilegais de minerac¸ ˜ao. Cabe destacar que tais medidas de
identificac¸ ˜ao autom´atica de minerac¸ ˜ao est˜ao fora do escopo da maioria dos trabalhos rela-
cionados, tendo em vista que os mesmos assumem que pode-se monitorar o uso de CPU e
mem´oria das m´aquinas potencialmente comprometidas, tornando assim o monitoramento
da rede, muito mais dif´ıcil, desnecess´ario (vide Tabela 1). A identificac¸ ˜ao automatizada de
minerac¸ ˜ao nas conex˜oes realizadas atrav´es de VPNs (Virtual Private Networks) tamb´em
traz seus seus pr´oprios desafios, a serem tratados em trabalhos futuros.
7.3. Monetizac¸ ˜ao da minerac¸ ˜ao em benef´ıcio p ´ublico
A monetizac¸ ˜ao da minerac¸ ˜ao, em benef´ıcio da pr´opria UFRJ, ´e potencialmente promis-
sora. Uma vez que a universidade tem per´ıodos de baixa movimentac¸ ˜ao ou ociosos, o
que faz com que os recursos sejam subutilizados, pode-se considerar a minerac¸ ˜ao durante
esses per´ıodos.
Cabe destacar que a monetizac¸ ˜ao da minerac¸ ˜ao, tanto para universidades quanto
para usu´arios dom´esticos, ´e promissora mas n˜ao-trivial. Existe ampla oportunidade
para se monetizar a minerac¸ ˜ao em infraestruturas privadas ou p´ublicas. Entretanto, esta
monetizac¸ ˜ao envolve prever o valor das criptomoedas e o excedente de energia com o qual
cada instituic¸ ˜ao pode contar a priori.
Em residˆencias dom´esticas em in´umeras cidades do Brasil, por exemplo, existe
um consumo m´ınimo de energia associado ao valor b´asico m´ınimo da conta de luz. Em
residˆencias nas quais n˜ao se alcance esse limite, ´e poss´ıvel monetizar o excedente. Alter-
nativamente, em ´org˜aos p´ublicos o custo da conta varia em faixas, e ´e importante que a
minerac¸ ˜ao legal ocorra dentro das faixas de interesse.
8. Considerac¸ ˜oes finais
Ataques de minerac¸ ˜ao vˆem se popularizando pelo fato de serem f´aceis de implementar
e potencialmente gerarem recursos financeiros que possam ser convertidos em qualquer
tipo de bens. Tais ataques, por sua vez, consistem em uma ameac¸a `a estabilidade das
pr´oprias criptomoedas. Afinal, se os ataques se tornarem muito prevalentes, pode haver
mais incentivo para que as mesmas sejam banidas de in´umeros pa´ıses, diminuindo seu
valor. Se o valor das moedas for reduzido a zero, os ataques de minerac¸ ˜ao perder˜ao seu
prop´osito. Portanto, em prol da estabilidade da Internet e das criptomoedas, ´e fundamental
o reconhecimento da prevalˆencia destes ataques, e o dom´ınio das formas de mitig´a-los.
Neste trabalho apresentou-se medic¸ ˜oes que indicam que ataques de minerac¸ ˜ao
ocorreram na UFRJ. Em particular, foi indicado que Bitcoin e Monero foram as duas
moedas mais mineradas. Em seguida, apresentou-se resultados de um experimento con-
trolado indicando os ganhos e custos desta minerac¸ ˜ao no campus universit´ario, em janeiro
e fevereiro de 2018. Finalmente, indicou-se tamb´em formas de mitigar estes ataques, que
foram aplicadas na UFRJ.
Acredita-se que este trabalho abre portas para in´umeros desenvolvimentos futu-
ros. Em particular, no Brasil o problema dos “gatos” nas favelas pode ser uma porta de
entrada para o novo problema dos “gatos” virtuais. Medic¸ ˜oes que permitam avaliar a pre-
valˆencia deste tipo de ataque s˜ao primordiais, e precisam ser feitas em colaborac¸ ˜ao entre
as empresas de prestac¸ ˜ao de servic¸os de energia e de comunicac¸ ˜ao.
Referˆencias
Andersen, D. (2014). Mining money with monero and cpu vec-
tor intrinsics. https://da-data.blogspot.com/2014/08/
minting-money-with-monero-and-cpu.html.
Avritzer, A., Tanikella, R., James, K., Cole, R. G., and Weyuker, E. (2010). Monitoring for
security intrusion using performance signatures. In WOSP/SIPEW Conf. Performance
engineering, pages 93–104. ACM.
Cherone, L. and Mahon, P. (2018). Minerblock extension. https://tinyurl.com/
minerblock.
Coinblockerlists (2018). Coinblockerlists. https://github.com/ZeroDot1/
CoinBlockerLists.
Hong, G., Yang, Z., and Yang, S. (2018). How you get shot in the back: A systematical
study about cryptojacking in the real world. In ACM SIGSAC Computer and Comm.
Security, pages 1701–1713.
Keramidas, R. (2018). No coin. https://github.com/keraf/NoCoin/blob/
master/src/js/background.js.
Kharraz, A., Ma, Z., Murley, P., Lever, C., and Mason, J. (2019). Outguard: Detecting
in-browser covert cryptocurrency mining in the wild. The Web Conference (WWW).
K¨uhrer, M., Rossow, C., and Holz, T. (2014). Paint it black: Evaluating the effectiveness
of malware blacklists. In Advances in Intrusion Detection, pages 1–21. Springer.
Marini, T. (2017). Gato de energia ´e usado para minerar bitcoins em Parais´opolis. Es-
tad˜ao.
Nadaud, G. C. A. (2012). Acesso `a energia el´etrica de populac¸oes urbanas de baixa renda:
o caso das favelas do Rio de Janeiro. UFRJ/COPPE/Progr. Planej. Energ´etico.
Nakamoto, S. (2008). Bitcoin: A peer-to-peer electronic cash system. Computers.
Penin, C. (2008). Combat, prevention and optimization of commercial losses of power.
R¨uth, J., Zimmermann, T., Wolsing, K., and Hohlfeld, O. (2018). Digging into browser-
based crypto mining. In IMC, pages 70–76. ACM.
Segura, J. (2018). The state of malicious cryptomining. https://tinyurl.com/
maliccry.
Setti, R. (2018). Febre de bitcoins cria uma nova ind´ustria de ’mineradores’. O Globo.
Wu, Z., Ou, Y., and Liu, Y. (2011). A taxonomy of network and computer attacks based
on responses. Info. Technology, Computer Engineering and Managm. Sciences, page 4.
Zimba, A. and Wang, Z. (2018). Crypto mining attacks in information systems: An
emerging threat to cyber security. Journal of Computer Information Systems, page 13.